<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>OrÃ§amento Profissional</title>
<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
<style>
  body{font-family:Arial,Helvetica,sans-serif;background:#f3f4f6;margin:0;padding:20px;}
  .container{max-width:800px;margin:auto;}
  h1{text-align:center;color:#111827;}
  .card{background:#fff;padding:20px;border-radius:12px;box-shadow:0 0 10px rgba(0,0,0,0.1);margin-bottom:20px;}
  label{display:block;margin-top:10px;font-weight:bold;}
  input,select,textarea{width:100%;padding:8px;margin-top:5px;border:1px solid #ccc;border-radius:8px;}
  button{background:#007bff;color:#fff;border:none;padding:10px 12px;border-radius:8px;margin-top:15px;cursor:pointer;}
  button:hover{background:#0056b3;}
  .nota{background:#fff;padding:15px;border-radius:10px;margin-top:20px;}
  .controle{background:#e8ffe8;padding:15px;border-radius:10px;}
  .qr-area{display:flex;align-items:center;gap:10px;margin-top:10px;}
  #qrcode{background:#fff;padding:8px;border-radius:10px;}
</style>
</head>
<body>
  <div class="container">
    <h1>ðŸ“‹ OrÃ§amento - GÃªnesis Azulejista</h1>

    <div class="card">
      <label>Nome do Cliente</label>
      <input type="text" id="nome">

      <label>DescriÃ§Ã£o do ServiÃ§o</label>
      <textarea id="descricao" rows="3"></textarea>

      <label>Valor Total (R$)</label>
      <input type="number" id="valor" step="0.01">

      <label>Valor Recebido / Sinal (R$)</label>
      <input type="number" id="sinal" step="0.01">

      <label>Como entrou</label>
      <select id="forma">
        <option value="PIX">PIX</option>
        <option value="Dinheiro">Dinheiro</option>
        <option value="CartÃ£o de CrÃ©dito">CartÃ£o de CrÃ©dito</option>
      </select>

      <label>Restante combinado para pagamento</label>
      <input type="date" id="dataRestante">

      <label>Data de InÃ­cio</label>
      <input type="date" id="inicio">

      <label>Data de TÃ©rmino</label>
      <input type="date" id="termino">

      <label>Prestador (Nome)</label>
      <input type="text" id="prestador">

      <label>CPF do Prestador</label>
      <input type="text" id="cpf" placeholder="000.000.000-00">

      <label>Chave PIX</label>
      <input type="text" id="chavePix" placeholder="Ex: 04461680681">

      <div class="qr-area">
        <div id="qrcode"></div>
        <button onclick="gerarQR()">Gerar QR PIX</button>
      </div>

      <button onclick="gerarNota()">Gerar Nota e Salvar</button>
    </div>

    <div id="notaGerada" class="nota" style="display:none;"></div>

    <div class="controle">
      <h3>ðŸ“Š Controle do MÃªs</h3>
      <div id="listaControle"></div>
      <strong>Total do MÃªs: R$ <span id="totalMes">0,00</span></strong>
    </div>
  </div>

<script>
let registros = JSON.parse(localStorage.getItem("orcamentos3")) || [];

function gerarQR(){
  const chave = document.getElementById('chavePix').value;
  const sinal = parseFloat(document.getElementById('sinal').value)||0;
  if(!chave){alert("Informe a chave PIX!");return;}
  const texto = `Pagamento para ${chave}\nValor: R$ ${sinal.toFixed(2)}`;
  document.getElementById('qrcode').innerHTML="";
  QRCode.toCanvas(texto,{width:150},function(err,canvas){
    if(err){alert("Erro ao gerar QR.");return;}
    document.getElementById('qrcode').appendChild(canvas);
  });
}

function gerarNota(){
  const nome=document.getElementById('nome').value;
  const descricao=document.getElementById('descricao').value;
  const valor=parseFloat(document.getElementById('valor').value)||0;
  const sinal=parseFloat(document.getElementById('sinal').value)||0;
  const forma=document.getElementById('forma').value;
  const dataRestante=document.getElementById('dataRestante').value;
  const inicio=document.getElementById('inicio').value;
  const termino=document.getElementById('termino').value;
  const prestador=document.getElementById('prestador').value;
  const cpf=document.getElementById('cpf').value;
  const chavePix=document.getElementById('chavePix').value;

  if(!nome || !valor){alert("Preencha nome e valor total!");return;}

  const notaHTML=`
    <h2>Nota de OrÃ§amento</h2>
    <p><strong>Cliente:</strong> ${nome}</p>
    <p><strong>ServiÃ§o:</strong> ${descricao}</p>
    <p><strong>Valor Total:</strong> R$ ${valor.toFixed(2)}</p>
    <p><strong>Valor Recebido:</strong> R$ ${sinal.toFixed(2)} (${forma})</p>
    <p><strong>Restante combinado:</strong> ${dataRestante?new Date(dataRestante).toLocaleDateString('pt-BR'):"-"}</p>
    <p><strong>InÃ­cio:</strong> ${inicio} - <strong>TÃ©rmino:</strong> ${termino}</p>
    <hr>
    <p><strong>Prestador:</strong> ${prestador} - CPF: ${cpf}</p>
    ${forma==="PIX"?`<p><strong>Chave PIX:</strong> ${chavePix}</p>`:""}
    <p style="text-align:center;">ðŸ’¼ GÃªnesis Azulejista - BH e RegiÃ£o</p>
  `;
  document.getElementById('notaGerada').innerHTML=notaHTML;
  document.getElementById('notaGerada').style.display="block";

  const registro={nome,descricao,valor,sinal,forma,dataRestante,inicio,termino,prestador,cpf,chavePix,data:new Date().toLocaleDateString()};
  registros.push(registro);
  localStorage.setItem("orcamentos3",JSON.stringify(registros));
  atualizarControle();
}

function atualizarControle(){
  const lista=document.getElementById('listaControle');
  lista.innerHTML="";
  let total=0;
  registros.forEach(r=>{
    total+=r.valor;
    lista.innerHTML+=`<p>ðŸ§± ${r.nome} - ${r.forma} - R$ ${r.valor.toFixed(2)} (${r.data})</p>`;
  });
  document.getElementById('totalMes').innerText=total.toFixed(2);
}

atualizarControle();
</script>
</body>
</html>

